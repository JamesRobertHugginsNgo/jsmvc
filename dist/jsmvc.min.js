"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}window.jsmvc||(window.jsmvc={}),jsmvc.collectionPropertyDescriptors={definedBy_collectionPropertyDescriptors:{value:!0},collectionData:{writable:!0},length:{get:function(){return this.collectionData?this.collectionData.length:0}},finalizeData:{value:function(e){for(var t=this;e!==this.length;)e<this.length?function(){var n=String(e);Object.defineProperty(t,n,{configurable:!0,enumerable:!0,set:function(e){var t=this;if(this.collectionData[n]!==e){var r=this.collectionData[n];this.itemSetter.call(this,e,function(){t.collectionData[n]=e,t.definedBy_eventfulPropertyDescriptors&&(t.trigger("change",n,e,r),t.trigger("change:".concat(n),e,r))})}},get:function(){var e=this;return this.itemGetter(function(){return e.collectionData[n]})}}),e++}():(delete this[String(e-1)],e--)}},itemSetter:{value:function(e,t){t()}},itemGetter:{value:function(e){return e()}},toArray:{value:function(){var r=this.collectionData.slice();return r.forEach(function(e,t){e.definedBy_modelPropertyDescriptors&&(r[t]=e.toJSON()),e.definedBy_collectionPropertyDescriptors&&(r[t]=e.toArray())}),r}}},["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"].forEach(function(s){jsmvc.collectionPropertyDescriptors[s]={value:function(){var e;this.collectionData||(this.collectionData=[]);for(var t=this.length,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=(e=Array.prototype[s]).call.apply(e,[this.collectionData].concat(n));return this.finalizeData(t),this.definedBy_eventfulPropertyDescriptors&&this.triggerEvents("change"),o}}}),["concat","includes","indexOf","join","lastIndexOf","slice","toSource","toString","toLocaleString","entries","every","filter","find","findIndex","forEach","keys","map","reduce","reduceRight","some","values"].forEach(function(i){jsmvc.collectionPropertyDescriptors[i]={value:function(){var e;this.collectionData||(this.collectionData=[]);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=Array.prototype[i]).call.apply(e,[this.collectionData].concat(r))}}}),jsmvc.collection=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(t)||(r=t,t=[]),jsmvc.eventful&&(r=jsmvc.eventful(r)),r.definedBy_collectionPropertyDescriptors||Object.defineProperties(r,jsmvc.collectionPropertyDescriptors),(e=r).push.apply(e,_toConsumableArray(t)),r},jsmvc.eventfulPropertyDescriptors={definedBy_eventfulPropertyDescriptors:{value:!0},eventfulEnabled:{writable:!0},enableEventful:{value:function(){this.eventfulEnabled=!0}},disableEventful:{value:function(){this.eventfulEnabled=!1}},eventfulData:{writable:!0},eventfulReferences:{writable:!0},addEvent:{value:function(n,e,t,r){var i=this,o=2<arguments.length&&void 0!==t&&t,s=3<arguments.length&&void 0!==r?r:this,a={handler:e,once:o,owner:s};if(this instanceof EventTarget){var l=function(){var e=a.handler,t=a.once,r=a.owner;e.apply(void 0,arguments),t&&i.removeEvents(n,e,t,r)};this.addEventListener(n,l,{once:o}),a.listener=l}return this.eventfulData||(this.eventfulData={}),this.eventfulData[n]||(this.eventfulData[n]=[]),this.eventfulData[n].push(a),s&&s!==this&&s.definedBy_eventfulPropertyDescriptors&&(s.eventfulReferences||(s.eventfulReferences={}),s.eventfulReferences[n]||(s.eventfulReferences[n]=[]),s.eventfulReferences[n].push({emitter:this,eventfulData:a})),this}},removeEvents:{value:function(e,t,r,n){if(this.eventfulData)for(var i in this.eventfulData)if(null==e||i===e){for(var o=0;o<this.eventfulData[i].length;){var s=this.eventfulData[i][o];if(null!=t&&s.handler!==t||null!=r&&s.once!==r||null!=n&&s.owner!==n)o++;else if(this instanceof EventTarget&&this.removeEventListener(i,s.listener),this.eventfulData[i].splice(o,1),n&&n!==this&&n.definedBy_eventfulPropertyDescriptors&&n.eventfulReferences[i])for(var a=0;a>n.eventfulReferences[i].length;){var l=n.eventfulReferences[i][a];l.emitter===this&&l.eventfulData===s?n.eventfulReferences.splice(a,1):a++}}if(null!=e)break}return this}},triggerEvents:{value:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!1!==this.eventfulEnabled&&this.eventfulData&&this.eventfulData[e]&&(this.eventfulData[e].forEach(function(e){var t=e.handler,r=e.owner;t.call.apply(t,[r].concat(n))}),this.removeEvents(e,null,!0,null)),this}},addEmitterEvent:{value:function(e,t,r,n){return e.definedBy_eventfulPropertyDescriptors&&e.addEvent(t,r,n,this),this}},removeEmitterEvents:{value:function(o,s,a,l){var c=this;if(this.eventfulReferences){var e=function(t){if(null==s||t===s){for(var e=[],r=0,n=c.eventfulReferences[t].length;r<n;r++){var i=c.eventfulReferences[t][r];if(null!=o&&i.emitter!==o||-1===e.indexOf(i.emitter)&&e.push(i.emitter),null!=o)break}if(e.forEach(function(e){e.definedBy_eventfulPropertyDescriptors&&e.removeEvents(t,a,l,c)}),null!=s)return"break"}};for(var t in this.eventfulReferences){if("break"===e(t))break}}return this}}},jsmvc.eventfulPropertyDescriptors.on=jsmvc.eventfulPropertyDescriptors.addEvent,jsmvc.eventfulPropertyDescriptors.off=jsmvc.eventfulPropertyDescriptors.removeEvents,jsmvc.eventfulPropertyDescriptors.trigger=jsmvc.eventfulPropertyDescriptors.triggerEvents,jsmvc.eventfulPropertyDescriptors.listenTo=jsmvc.eventfulPropertyDescriptors.addEmitterEvent,jsmvc.eventfulPropertyDescriptors.stopListening=jsmvc.eventfulPropertyDescriptors.removeEmitterEvents,jsmvc.eventful=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.definedBy_eventfulPropertyDescriptors||Object.defineProperties(e,jsmvc.eventfulPropertyDescriptors),e},jsmvc.modelPropertyDescriptors={definedBy_modelPropertyDescriptors:{value:!0},propertyData:{writable:!0},setProperty:{value:function(n,e,t,r){var i=1<arguments.length&&void 0!==e?e:this[n],o=2<arguments.length&&void 0!==t?t:function(e,t){return t()},s=3<arguments.length&&void 0!==r?r:function(e){return e()},a=Object.getOwnPropertyDescriptor(this,n);return a&&(a.get||a.set)||(void 0!==i&&(this.propertyData||(this.propertyData={}),this.propertyData[n]=i),delete this[n],Object.defineProperty(this,n,{configurable:!0,enumerable:!0,set:function(e){var t,r=this;this.propertyData&&this.propertyData[n]===e||(this.propertyData&&void 0!==this.propertyData[n]&&(t=this.propertyData[n]),o.call(this,e,function(){r.propertyData||(r.propertyData={}),r.propertyData[n]=e,r.definedBy_eventfulPropertyDescriptors&&(r.triggerEvents("change",n,e,t),r.triggerEvents("change:".concat(n),e,t))}))},get:function(){var e=this;return s.call(this,function(){if(e.propertyData)return e.propertyData[n]})}})),this}},unsetProperty:{value:function(e){var t,r=Object.getOwnPropertyDescriptor(this,e);r&&(r.get||r.set)&&(this.propertyData&&(t=this.propertyData[e]),delete this.propertyData[e],delete this[e],void 0!==t&&(this[e]=t));return this}},toJSON:{value:function(){var e=Object.assign({},this.propertyData);for(var t in e)e[t].definedBy_modelPropertyDescriptors&&(e[t]=e[t].toJSON()),e[t].definedBy_collectionPropertyDescriptors&&(e[t]=e[t].toArray());return e}}},jsmvc.model=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};for(var t in jsmvc.eventful&&(e=jsmvc.eventful(e)),e.definedBy_modelPropertyDescriptors||Object.defineProperties(e,jsmvc.modelPropertyDescriptors),e)e.setProperty(t);return e},jsmvc.viewPropertyDescriptors={definedBy_viewPropertyDescriptors:{value:!0},attributeData:{writable:!0},defineAttributes:{value:function(e){return this.attributeData=e,this}},renderAttributesPromise:{writable:!0},renderAttributes:{value:function(e){function t(){if(e){Array.isArray(e)||(e=[e]);var r=[];return e.forEach(function(e){var t=e(l);t instanceof Promise&&r.push(t)}),0!==r.length?Promise.all(r):void 0}}var l=this,r=function r(e,n){if("function"==typeof e)return r(e(),n);if("object"===_typeof(e)&&null!==e){if(e instanceof Promise)return e.then(function(e){return r(e,n)});if(Array.isArray(e)){var i=[];return e.forEach(function(e){var t=r(e,n);t instanceof Promise&&i.push(t)}),0!==i.length?Promise.all(i):void 0}var t=[];for(var o in e){var s=r(e[o],o);s instanceof Promise&&t.push(s)}return 0!==t.length?Promise.all(t):void 0}if("boolean"==typeof e&&e)return r("",n);if(n)if(null!=e&&!1!==e){var a=String(e);l.hasAttribute(n)&&l.getAttribute(n)===a||l.setAttribute(n,a)}else l.hasAttribute(n)&&l.removeAttribute(n)}(this.attributeData,null);if(r instanceof Promise)this.renderAttributesPromise=r.then(function(){return t()}).then(function(){return l});else{var n=t();n instanceof Promise?this.renderAttributesPromise=n.then(function(){return l}):this.renderAttributesPromise=Promise.resolve(this)}return this}},childElementData:{writable:!0},defineChildElements:{value:function(e){return this.childElementData=e,this}},renderChildElementsPromise:{writable:!0},renderChildElements:{value:function(t,e){for(var n=this,r=!(1<arguments.length&&void 0!==e)||e;this.firstChild;)this.removeChild(this.firstChild);var i=document.createDocumentFragment(),o=function n(e,i){if("function"==typeof e)return n(e(),i);if("object"===_typeof(e)&&!(e instanceof HTMLElement||e instanceof Text)){if(null===e)return void i.parentNode.removeChild(i);if(e instanceof Promise)return e.then(function(e){return n(e,i)});if(Array.isArray(e)){var o=[];return e.forEach(function(e){var t=i.parentNode.insertBefore(document.createTextNode(" "),i),r=n(e,t);r instanceof Promise&&o.push(r)}),i.parentNode.removeChild(i),0!==o.length?Promise.all(o):void 0}var t=[];for(var r in e){var s=i.parentNode.insertBefore(document.createTextNode(" "),i),a=n(e[r],s);a instanceof Promise&&t.push(a)}return i.parentNode.removeChild(i),0!==t.length?Promise.all(t):void 0}if("boolean"==typeof e||"number"==typeof e||"string"==typeof e){var l=document.createElement("div");l.innerHTML=String(e);for(var c=[],u=0,f=l.childNodes.length;u<f;u++)c.push(l.childNodes[u]);return n(c,i)}(e instanceof HTMLElement||e instanceof Text)&&i.parentNode.insertBefore(e,i),i.parentNode.removeChild(i)}(this.childElementData,i.appendChild(document.createTextNode(" ")));this.appendChild(i);function s(){function e(){if(t){Array.isArray(t)||(t=[t]);var r=[];return t.forEach(function(e){var t=e(n);t instanceof Promise&&r.push(t)}),0!==r.length?Promise.all(r):void 0}}return o instanceof Promise?o.then(function(){return e()}):e()}var a=[];if(r){var l=this.childElementData;(l=Array.isArray(l)?l.slice():[l]).forEach(function(e){e.definedBy_viewPropertyDescriptors&&a.push(e.render().renderPromise)})}if(0!==a.length)this.renderChildElementsPromise=Promise.all(a).then(function(){return s()}).then(function(){return n});else{var c=s();c instanceof Promise?this.renderChildElementsPromise=c.then(function(){return n}):this.renderChildElementsPromise=Promise.resolve(this)}return this}},renderPromise:{writable:!0},render:{value:function(e,t){function r(){if(e){Array.isArray(e)||(e=[e]);var r=[];return e.forEach(function(e){var t=e(n);t instanceof Promise&&r.push(t)}),0!==r.length?Promise.all(r):void 0}}var n=this,i=!(1<arguments.length&&void 0!==t)||t,o=[];if(this.attributeData&&o.push(this.renderAttributes().renderAttributesPromise),this.childElementData&&o.push(this.renderChildElements(null,i).renderChildElementsPromise),0!==o.length)this.renderPromise=Promise.all(o).then(function(){return r()}).then(function(){return n});else{var s=r();s instanceof Promise?this.renderPromise=s.then(function(){return n}):this.renderPromise=Promise.resolve(this)}return this}},cleanUpHandler:{writable:!0},cleanUp:{value:function(){this.cleanUpChildNodes(),this.cleanUpHandler&&this.cleanUpHandler.call(this),this.definedBy_eventfulPropertyDescriptors&&this.triggerEvents("cleanUp")}},cleanUpChildNodes:{value:function(){for(var e=0,t=this.childNodes.length;e<t;e++){var r=this.childNodes[e];r.definedBy_viewPropertyDescriptors&&r.cleanUp()}}}},jsmvc.view=function(e,t,r,n){if("string"==typeof e&&(e=document.createElement(e)),jsmvc.eventful&&(e=jsmvc.eventful(e)),e.firstChild){for(var i,o=[],s=0,a=e.childNodes.length;s<a;s++)o.push(e.childNodes[s]);if(0<o.length)(i=r=Array.isArray(r)?r.slice():null==r?[]:[r]).unshift.apply(i,o)}return e.definedBy_viewPropertyDescriptors||Object.defineProperties(e,jsmvc.viewPropertyDescriptors),e.defineAttributes(t).defineChildElements(r).render(n,!1)},["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"].forEach(function(i){jsmvc.view[i]=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=jsmvc).view.apply(e,[i].concat(r))}});